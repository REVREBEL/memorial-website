globalThis.process ??= {}; globalThis.process.env ??= {};
import { j as jsxRuntimeExports, S as Section, B as Block, H as Heading, G as Grid, L as Link, I as Image, P as Paragraph, b as baseUrl, D as DevLinkProvider } from './BackgroundVideo_ASmHyXWF.mjs';
import { a as reactExports } from './_@astro-renderers_1Hg5a3QD.mjs';

function Stories({
  as: _Component = Section,
  featuredFeaturedTitle = "The heart of her family",
  featuredFeaturedTitleTag = "h3",
  featuredText = "Memories and photos honoring her love and devotion to those closest to her.",
  featuredTagText = "Family",
  smallFeature1TagText = "Traditions",
  smallFeature1Title = "Recipes and cherished rituals",
  smallFeature1TitleTag = "h3",
  smallFeature1BodyText = "Favorite dishes, holiday moments, and the warmth she brought to every table.",
  smallFeature2TagText = "Travel",
  smallFeature2Title = "Journeys and new horizons",
  smallFeature2TitleTag = "h3",
  smallFeature2Text = "Photos and stories from adventures that sparked her joy and curiosity.",
  smallFeature2Image = "https://cdn.prod.website-files.com/69219eaa23d0fd8b7effe1fe/69219fe3ace6d8206cfc4d8f_de1ab5b8-1007-400f-9ae2-1c7a75738f98.avif",
  smallFeature1Image = "https://cdn.prod.website-files.com/69219eaa23d0fd8b7effe1fe/69219fe3b36d2cab360906cb_627e067d-8a03-4693-8344-eff8407c4a73.avif",
  textFeature1TagText = "h3",
  textFeature1Title = "Kindness remembered",
  textFeature1Text = "Moments when her caring spirit made a difference for others.",
  textFeature2TagText = "h3",
  textFeature2Title = "A lifelong learner",
  textFeature2Text = "How her curiosity and wisdom inspired everyone she met.",
  textFeature3Title = "Laughter shared",
  textFeature3TitleTag = "h3",
  textFeature3Text = "Stories that capture her humor and the light she brought to every day.",
  textFeature4Tag = "h3",
  textFeature5Tag = "h3",
  textFeature5Text = "Tributes from friends who shared in her journey.",
  textFeature5Text2 = "Special locations filled with meaning and memories.",
  textFeature4Title = "Beloved places",
  textFeature5Title = "Enduring friendships",
  textFeature5Visibility = true,
  textFeature4Visibility = true,
  textFeature3Visibility = true,
  textFeature2Visibility = true,
  textFeature1Visibility = true,
  textFeature1Link = {
    href: "#"
  },
  textFeature2Link = {
    href: "#"
  },
  textFeature3Link = {
    href: "#"
  },
  textFeature4Link = {
    href: "#"
  },
  textFeature5Link = {
    href: "#"
  },
  smallFeature1Visibility = true,
  smallFeature1Link = {
    href: "#"
  },
  smallFeature2Visibility = true,
  smallFeature2Link = {
    href: "#"
  },
  featuredImage = "https://cdn.prod.website-files.com/69219eaa23d0fd8b7effe1fe/69219fe39e116830f4ca38d9_87bfb04f-a3b7-4de1-ad39-af9ae421637f.avif",
  smallFeature2AltText = "image of timeline with historic transit milestones",
  smallFeature1AltText = "[background image] image of bakery's history wall",
  featuredAltText = "birthday party celebration"
}) {
  return /* @__PURE__ */ jsxRuntimeExports.jsx(_Component, { className: "section", tag: "section", children: /* @__PURE__ */ jsxRuntimeExports.jsxs(Block, { className: "container", tag: "div", children: [
    /* @__PURE__ */ jsxRuntimeExports.jsx(Block, { className: "footer-statment", tag: "div", children: /* @__PURE__ */ jsxRuntimeExports.jsx(Heading, { className: "heading_h2 max-width_large text-color-dark-green", tag: "h2", children: "Stories that celebrate a beautiful life" }) }),
    /* @__PURE__ */ jsxRuntimeExports.jsxs(Grid, { className: "grid_4-col tablet-1-col-1 gap-medium", children: [
      /* @__PURE__ */ jsxRuntimeExports.jsxs(
        Link,
        {
          className: "content-block-link w-node-b84620cd-ea0e-d376-493f-57a1cd918680-cd91867a",
          id: "w-node-_7c7fb997-9efe-3ef4-c59d-830f05928193-0592818f",
          button: false,
          block: "inline",
          options: {
            href: "#"
          },
          children: [
            /* @__PURE__ */ jsxRuntimeExports.jsx(
              Block,
              {
                className: "image-ratio_1x1 margin-bottom_xsmall w-node-b84620cd-ea0e-d376-493f-57a1cd918681-cd91867a",
                id: "w-node-_7c7fb997-9efe-3ef4-c59d-830f05928195-0592818f",
                tag: "div",
                children: /* @__PURE__ */ jsxRuntimeExports.jsx(
                  Image,
                  {
                    className: "image_cover",
                    width: "600",
                    height: "600",
                    loading: "lazy",
                    "data-aisg-image-id": "33540502-00bc-42b0-a72a-f16adffae416",
                    src: featuredImage
                  }
                )
              }
            ),
            /* @__PURE__ */ jsxRuntimeExports.jsx(Block, { className: "tag_group margin-bottom_xsmall", tag: "div", children: /* @__PURE__ */ jsxRuntimeExports.jsx(Block, { className: "tag is-green", tag: "div", children: featuredTagText }) }),
            /* @__PURE__ */ jsxRuntimeExports.jsx(Heading, { className: "heading_h2", tag: featuredFeaturedTitleTag, children: featuredFeaturedTitle }),
            /* @__PURE__ */ jsxRuntimeExports.jsx(Paragraph, { className: "paragraph_small", children: featuredText })
          ]
        }
      ),
      /* @__PURE__ */ jsxRuntimeExports.jsxs(
        Block,
        {
          className: "flex_vertical gap-small w-node-b84620cd-ea0e-d376-493f-57a1cd91868a-cd91867a",
          id: "w-node-_7c7fb997-9efe-3ef4-c59d-830f0592819f-0592818f",
          tag: "div",
          children: [
            smallFeature1Visibility ? /* @__PURE__ */ jsxRuntimeExports.jsxs(
              Link,
              {
                className: "content-block-link",
                button: false,
                block: "inline",
                options: smallFeature1Link,
                children: [
                  /* @__PURE__ */ jsxRuntimeExports.jsx(
                    Block,
                    {
                      className: "image-ratio_3x2 margin-bottom_xsmall ratio_1x1_mobile-l w-node-b84620cd-ea0e-d376-493f-57a1cd91868c-cd91867a",
                      id: "w-node-_7c7fb997-9efe-3ef4-c59d-830f059281a2-0592818f",
                      tag: "div",
                      children: /* @__PURE__ */ jsxRuntimeExports.jsx(
                        Image,
                        {
                          className: "image_cover",
                          width: "276",
                          height: "184",
                          loading: "lazy",
                          "data-aisg-image-id": "cfe7c69a-449b-4da5-8d20-9f7f5a3ab1fc",
                          src: smallFeature1Image
                        }
                      )
                    }
                  ),
                  /* @__PURE__ */ jsxRuntimeExports.jsx(Block, { className: "tag_group margin-bottom_xsmall", tag: "div", children: /* @__PURE__ */ jsxRuntimeExports.jsx(Block, { className: "tag is-green", tag: "div", children: smallFeature1TagText }) }),
                  /* @__PURE__ */ jsxRuntimeExports.jsx(Heading, { className: "heading_h4 margin-bottom_xxsmall", tag: smallFeature1TitleTag, children: smallFeature1Title }),
                  /* @__PURE__ */ jsxRuntimeExports.jsx(Paragraph, { className: "paragraph_small margin-bottom_none", children: smallFeature1BodyText })
                ]
              }
            ) : null,
            smallFeature2Visibility ? /* @__PURE__ */ jsxRuntimeExports.jsxs(
              Link,
              {
                className: "content-block-link",
                button: false,
                block: "inline",
                options: smallFeature2Link,
                children: [
                  /* @__PURE__ */ jsxRuntimeExports.jsx(
                    Block,
                    {
                      className: "image-ratio_3x2 margin-bottom_xsmall ratio_1x1_mobile-l w-node-b84620cd-ea0e-d376-493f-57a1cd918696-cd91867a",
                      id: "w-node-f5da638d-a9e1-b7e6-f734-2f967c4690fd-0592818f",
                      tag: "div",
                      children: /* @__PURE__ */ jsxRuntimeExports.jsx(
                        Image,
                        {
                          className: "image_cover",
                          width: "276",
                          height: "184",
                          loading: "lazy",
                          "data-aisg-image-id": "5ef766dc-bcd6-4a9d-9ae3-5efd74adaccd",
                          src: smallFeature2Image
                        }
                      )
                    }
                  ),
                  /* @__PURE__ */ jsxRuntimeExports.jsx(Block, { className: "tag_group margin-bottom_xsmall", tag: "div", children: /* @__PURE__ */ jsxRuntimeExports.jsx(Block, { className: "tag is-green", tag: "div", children: smallFeature2TagText }) }),
                  /* @__PURE__ */ jsxRuntimeExports.jsx(Heading, { className: "heading_h4 margin-bottom_xxsmall", tag: smallFeature2TitleTag, children: smallFeature2Title }),
                  /* @__PURE__ */ jsxRuntimeExports.jsx(Paragraph, { className: "paragraph_small margin-bottom_none", children: smallFeature2Text })
                ]
              }
            ) : null
          ]
        }
      ),
      /* @__PURE__ */ jsxRuntimeExports.jsxs(
        Block,
        {
          className: "flex_vertical gap-small w-node-b84620cd-ea0e-d376-493f-57a1cd91869f-cd91867a",
          id: "w-node-_7c7fb997-9efe-3ef4-c59d-830f059281b8-0592818f",
          tag: "div",
          children: [
            textFeature1Visibility ? /* @__PURE__ */ jsxRuntimeExports.jsxs(
              Link,
              {
                className: "content-block-link",
                button: false,
                block: "inline",
                options: textFeature1Link,
                children: [
                  /* @__PURE__ */ jsxRuntimeExports.jsx(Heading, { className: "heading_h4 margin-bottom_xxsmall", tag: textFeature1TagText, children: textFeature1Title }),
                  /* @__PURE__ */ jsxRuntimeExports.jsx(Paragraph, { className: "paragraph_small margin-bottom_none", children: textFeature1Text }),
                  /* @__PURE__ */ jsxRuntimeExports.jsx(Block, { className: "divider", tag: "div" })
                ]
              }
            ) : null,
            textFeature2Visibility ? /* @__PURE__ */ jsxRuntimeExports.jsxs(
              Link,
              {
                className: "content-block-link",
                button: false,
                block: "inline",
                options: textFeature2Link,
                children: [
                  /* @__PURE__ */ jsxRuntimeExports.jsx(Heading, { className: "heading_h4 margin-bottom_xxsmall", tag: textFeature2TagText, children: textFeature2Title }),
                  /* @__PURE__ */ jsxRuntimeExports.jsx(Paragraph, { className: "paragraph_small margin-bottom_none", children: textFeature2Text }),
                  /* @__PURE__ */ jsxRuntimeExports.jsx(Block, { className: "divider", tag: "div" })
                ]
              }
            ) : null,
            textFeature3Visibility ? /* @__PURE__ */ jsxRuntimeExports.jsxs(
              Link,
              {
                className: "content-block-link",
                button: false,
                block: "inline",
                options: textFeature3Link,
                children: [
                  /* @__PURE__ */ jsxRuntimeExports.jsx(Heading, { className: "heading_h4 margin-bottom_xxsmall", tag: textFeature3TitleTag, children: textFeature3Title }),
                  /* @__PURE__ */ jsxRuntimeExports.jsx(Paragraph, { className: "paragraph_small margin-bottom_none", children: textFeature3Text }),
                  /* @__PURE__ */ jsxRuntimeExports.jsx(Block, { className: "divider", tag: "div" })
                ]
              }
            ) : null,
            textFeature4Visibility ? /* @__PURE__ */ jsxRuntimeExports.jsxs(
              Link,
              {
                className: "content-block-link",
                button: false,
                block: "inline",
                options: textFeature4Link,
                children: [
                  /* @__PURE__ */ jsxRuntimeExports.jsx(Heading, { className: "heading_h4 margin-bottom_xxsmall", tag: textFeature4Tag, children: textFeature4Title }),
                  /* @__PURE__ */ jsxRuntimeExports.jsx(Paragraph, { className: "paragraph_small margin-bottom_none", children: textFeature5Text2 }),
                  /* @__PURE__ */ jsxRuntimeExports.jsx(Block, { className: "divider", tag: "div" })
                ]
              }
            ) : null,
            textFeature5Visibility ? /* @__PURE__ */ jsxRuntimeExports.jsxs(
              Link,
              {
                className: "content-block-link",
                button: false,
                block: "inline",
                options: textFeature5Link,
                children: [
                  /* @__PURE__ */ jsxRuntimeExports.jsx(Heading, { className: "heading_h4 margin-bottom_xxsmall", tag: textFeature5Tag, children: textFeature5Title }),
                  /* @__PURE__ */ jsxRuntimeExports.jsx(Paragraph, { className: "paragraph_small margin-bottom_none", children: textFeature5Text }),
                  /* @__PURE__ */ jsxRuntimeExports.jsx(Block, { className: "divider", tag: "div" })
                ]
              }
            ) : null
          ]
        }
      )
    ] })
  ] }) });
}

function StoriesSection() {
  const [memories, setMemories] = reactExports.useState([]);
  const [loading, setLoading] = reactExports.useState(true);
  const [error, setError] = reactExports.useState(null);
  reactExports.useEffect(() => {
    console.log("[StoriesSection] Component mounted, fetching memories...");
    fetchMemories();
  }, []);
  const fetchMemories = async () => {
    try {
      console.log("[StoriesSection] Fetching from:", `${baseUrl}/api/memories`);
      const response = await fetch(`${baseUrl}/api/memories`);
      console.log("[StoriesSection] Response status:", response.status);
      if (response.ok) {
        const data = await response.json();
        console.log("[StoriesSection] Fetched memories:", data?.length || 0, "items");
        if (data && Array.isArray(data) && data.length > 0) {
          data.forEach((mem, idx) => {
            console.log(`[StoriesSection] Memory ${idx}:`, {
              id: mem.id,
              headline: mem.headline,
              hasMediaKey: !!mem.mediaKey,
              mediaKey: mem.mediaKey,
              mediaType: mem.mediaType
            });
          });
        }
        setMemories(Array.isArray(data) ? data : []);
      } else {
        const errorText = await response.text();
        console.error("[StoriesSection] Error response:", errorText);
        setError(`Failed to load memories: ${response.status}`);
      }
    } catch (err) {
      console.error("[StoriesSection] Error fetching memories:", err);
      setError("Failed to load memories");
    } finally {
      setLoading(false);
    }
  };
  const truncateText = (text, maxLength) => {
    if (!text) return "";
    if (text.length <= maxLength) return text;
    return text.substring(0, maxLength) + "...";
  };
  const getMediaUrl = (memory) => {
    if (!memory.mediaKey) {
      console.log("[StoriesSection] No mediaKey for memory:", memory.id);
      return void 0;
    }
    const url = `${baseUrl}/api/media/${memory.mediaKey}`;
    console.log("[StoriesSection] Constructed media URL:", url);
    return url;
  };
  const getFirstTag = (tags) => {
    if (!tags || !Array.isArray(tags) || tags.length === 0) return void 0;
    return tags[0];
  };
  if (error) {
    console.error("[StoriesSection] Rendering error state:", error);
    return /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { style: {
      padding: "4rem 2rem",
      textAlign: "center",
      fontFamily: "var(--body-font)",
      color: "var(--destructive)",
      backgroundColor: "var(--background)"
    }, children: [
      /* @__PURE__ */ jsxRuntimeExports.jsx("p", { children: error }),
      /* @__PURE__ */ jsxRuntimeExports.jsx(
        "button",
        {
          onClick: () => {
            setError(null);
            setLoading(true);
            fetchMemories();
          },
          style: {
            marginTop: "1rem",
            padding: "0.5rem 1rem",
            backgroundColor: "var(--primary)",
            color: "var(--primary-foreground)",
            border: "none",
            borderRadius: "var(--radius)",
            cursor: "pointer"
          },
          children: "Retry"
        }
      )
    ] });
  }
  if (loading) {
    console.log("[StoriesSection] Rendering loading state");
    return /* @__PURE__ */ jsxRuntimeExports.jsx("div", { style: {
      padding: "4rem 2rem",
      textAlign: "center",
      fontFamily: "var(--body-font)",
      color: "var(--foreground)",
      backgroundColor: "var(--background)"
    }, children: "Loading stories..." });
  }
  if (!memories || memories.length === 0) {
    console.log("[StoriesSection] No memories found, not rendering Stories component");
    return null;
  }
  console.log("[StoriesSection] Rendering Stories component with", memories.length, "memories");
  const featured = memories[0];
  const smallFeature1 = memories[1];
  const smallFeature2 = memories[2];
  const textFeature1 = memories[3];
  const textFeature2 = memories[4];
  const textFeature3 = memories[5];
  const textFeature4 = memories[6];
  const textFeature5 = memories[7];
  try {
    const storiesProps = {};
    if (featured) {
      storiesProps.featuredFeaturedTitle = featured.headline || "";
      storiesProps.featuredText = truncateText(featured.memory || "", 150);
      storiesProps.featuredTagText = getFirstTag(featured.tags);
      console.log("[StoriesSection] Featured memory check:", {
        hasMediaKey: !!featured.mediaKey,
        mediaKey: featured.mediaKey,
        mediaType: featured.mediaType,
        isPhoto: featured.mediaType === "photo"
      });
      if (featured.mediaKey && featured.mediaType === "photo") {
        const mediaUrl = getMediaUrl(featured);
        console.log("[StoriesSection] Setting featured image URL:", mediaUrl);
        if (mediaUrl) {
          storiesProps.featuredImage = mediaUrl;
          storiesProps.featuredAltText = featured.headline || "Featured memory";
        }
      } else {
        console.log("[StoriesSection] Featured memory has no photo - skipping image");
      }
    }
    if (smallFeature1) {
      storiesProps.smallFeature1Title = smallFeature1.headline || "";
      storiesProps.smallFeature1BodyText = truncateText(smallFeature1.memory || "", 100);
      storiesProps.smallFeature1TagText = getFirstTag(smallFeature1.tags);
      if (smallFeature1.mediaKey && smallFeature1.mediaType === "photo") {
        const mediaUrl = getMediaUrl(smallFeature1);
        console.log("[StoriesSection] Setting smallFeature1 image URL:", mediaUrl);
        if (mediaUrl) {
          storiesProps.smallFeature1Image = mediaUrl;
          storiesProps.smallFeature1AltText = smallFeature1.headline || "Memory";
        }
      }
    } else {
      storiesProps.smallFeature1Visibility = { hidden: true };
    }
    if (smallFeature2) {
      storiesProps.smallFeature2Title = smallFeature2.headline || "";
      storiesProps.smallFeature2Text = truncateText(smallFeature2.memory || "", 100);
      storiesProps.smallFeature2TagText = getFirstTag(smallFeature2.tags);
      if (smallFeature2.mediaKey && smallFeature2.mediaType === "photo") {
        const mediaUrl = getMediaUrl(smallFeature2);
        console.log("[StoriesSection] Setting smallFeature2 image URL:", mediaUrl);
        if (mediaUrl) {
          storiesProps.smallFeature2Image = mediaUrl;
          storiesProps.smallFeature2AltText = smallFeature2.headline || "Memory";
        }
      }
    } else {
      storiesProps.smallFeature2Visibility = { hidden: true };
    }
    if (textFeature1) {
      storiesProps.textFeature1Title = textFeature1.headline || "";
      storiesProps.textFeature1Text = truncateText(textFeature1.memory || "", 80);
    } else {
      storiesProps.textFeature1Visibility = { hidden: true };
    }
    if (textFeature2) {
      storiesProps.textFeature2Title = textFeature2.headline || "";
      storiesProps.textFeature2Text = truncateText(textFeature2.memory || "", 80);
    } else {
      storiesProps.textFeature2Visibility = { hidden: true };
    }
    if (textFeature3) {
      storiesProps.textFeature3Title = textFeature3.headline || "";
      storiesProps.textFeature3Text = truncateText(textFeature3.memory || "", 80);
    } else {
      storiesProps.textFeature3Visibility = { hidden: true };
    }
    if (textFeature4) {
      storiesProps.textFeature4Title = textFeature4.headline || "";
    } else {
      storiesProps.textFeature4Visibility = { hidden: true };
    }
    if (textFeature5) {
      storiesProps.textFeature5Title = textFeature5.headline || "";
      storiesProps.textFeature5Text = truncateText(textFeature5.memory || "", 80);
      storiesProps.textFeature5Text2 = truncateText(textFeature5.memory || "", 80);
    } else {
      storiesProps.textFeature5Visibility = { hidden: true };
    }
    console.log("[StoriesSection] Final props keys:", Object.keys(storiesProps));
    console.log("[StoriesSection] Has featuredImage:", !!storiesProps.featuredImage);
    console.log("[StoriesSection] featuredImage value:", storiesProps.featuredImage);
    return /* @__PURE__ */ jsxRuntimeExports.jsx(DevLinkProvider, { children: /* @__PURE__ */ jsxRuntimeExports.jsx(Stories, { ...storiesProps }) });
  } catch (err) {
    console.error("[StoriesSection] Error rendering Stories:", err);
    console.error("[StoriesSection] Error stack:", err instanceof Error ? err.stack : "No stack");
    return null;
  }
}

export { StoriesSection as S };
